CREATE OR REPLACE TEMPORARY TABLE seconds_dim(seconds int)
AS
SELECT datediff(seconds, '2022-08-01', CURRENT_DATE);

CREATE OR REPLACE TABLE "TIME_DIMENSION"
AS
SELECT TIMEADD(seconds, SEQ4(), '2022-08-01') AS "TIMESTAMP",
            SPLIT_PART("TIMESTAMP", ' ',2) ::TIME AS "TIME",
            hour("TIMESTAMP") :: VARCHAR AS "HOUR",
            minute("TIMESTAMP") :: VARCHAR AS "MINUTE",
            second("TIMESTAMP") :: VARCHAR AS "SECOND"
            FROM TABLE(GENERATOR(ROWCOUNT=>(SELECT MAX(seconds) FROM seconds_dim)));

CREATE OR REPLACE TABLE "TIME_DIMENSION" AS 
SELECT *,
    REPLACE("TIME", ':','') ::VARCHAR AS "TIME_ID"
FROM "TIME_DIMENSION";
